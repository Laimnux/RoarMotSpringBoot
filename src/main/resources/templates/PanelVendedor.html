<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title th:text="${title} ?: 'Panel Vendedor - ROARMOT'">Panel Vendedor - ROARMOT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
     <!-- Enlace a Font Awesome para los iconos -->
    <!-- C√ìDIGO CORREGIDO (QUITAR INTEGRITY) -->
    <link rel="stylesheet" 
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
        crossorigin="anonymous" 
        referrerpolicy="no-referrer" />

    <!-- üîë A√ëADIDO: ETIQUETAS META DE SPRING SECURITY CSRF üîë -->
    <!-- Esto inyecta el token, el nombre de la cabecera, y el nombre del par√°metro en el DOM. -->
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <meta name="_csrf_parameterName" th:content="${_csrf.parameterName}"/>

    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        /* Estilos de color solicitados para el fragmento */
        .text-custom-green { color: #00DB9D; }
        .bg-custom-light-green { background-color: #CDFFEA; }
        .border-custom-medium-green { border-color: #99E9C3; }
        .focus-ring-custom-green:focus {
            --tw-ring-color: #00DB9D;
        }
        .btn-submit {
            background-color: #00DB9D;
            transition: all 0.2s;
        }
        .btn-submit:hover {
            background-color: #00B380;
        }
    </style>
</head>
<body class="bg-gray-200 flex font-sans min-h-screen text-sm">

    <!-- BARRA LATERAL (SIDEBAR) -->
    <aside class="w-72 bg-gray-900 text-white p-6 flex flex-col">
        <!-- Reemplazo del sidebar: Usamos el th:replace para incluir el fragmento del men√∫ -->
        <!-- NOTA: Debes pasar 'activePage' en el modelo para que se resalte el √≠tem correcto -->
        <div th:replace="~{fragmentos/panelVendedor/sidebarPanel :: sidebar}">
            <!-- Contenido de fallback si no se encuentra el fragmento -->
        </div>
    </aside>

    <main class="flex-1 p-10 overflow-auto relative">
        <div class="absolute top-4 right-6 text-sm bg-white px-4 py-2 rounded shadow border border-gray-200 z-10">
            Bienvenido, <span class="font-semibold text-pink-600" th:text="${nombreUsuario} ?: 'Usuario'">Usuario</span>
        </div>

        <!-- INSERCI√ìN DIN√ÅMICA DEL CONTENIDO -->
        <!-- El controlador define ${contentFragment} (ej: fragmentos/panelVendedor/editProduct) -->
        <!-- Y se inserta el fragmento 'content' de ese archivo. -->
        <div th:insert="~{${contentFragment} :: content}">
            <!-- Contenido de fallback si contentFragment es nulo o el archivo no existe -->
            <h1 class="text-xl font-bold text-gray-700">Contenido Principal del Panel</h1>
            <p class="text-gray-500">Seleccione una opci√≥n del men√∫ lateral.</p>
        </div>
    </main>

    <script>
        // Inicializa los √≠conos de Lucide
        lucide.createIcons();
    </script>

    <script>
        // para la tarjeta Reporte Estad√≠sticos
        function descargarReporte(tipo) {
        console.log('üü¶ Bot√≥n clickeado, tipo:', tipo);
        
        let url = '';
        
        switch(tipo) {
            case 'marca':
                url = '/api/reportes/productos-por-marca';
                break;
            case 'talla':
                url = '/api/reportes/productos-por-talla';
                break;
            case 'subcategoria':
                url = '/api/reportes/productos-por-subcategoria';
                break;
            default:
                console.error('‚ùå Tipo desconocido:', tipo);
                return;
        }
        
        console.log('üîó URL generada:', url);
        
        // Verificar que la URL es v√°lida
        if (url && url.startsWith('/api/reportes/')) {
            console.log('üì• Abriendo URL en nueva pesta√±a...');
            window.open(url, '_blank');
        } else {
            console.error('‚ùå URL inv√°lida:', url);
            alert('Error: No se pudo generar la URL para el reporte');
        }
    }
    </script>
    
</body>
</html>

